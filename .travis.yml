dist: xenial

language: python

cache: pip

python:
  - "3.6"
  - "3.7"
  - "3.8"

stages:
  - build
  - test

jobs:
  include:
    - stage: build
      name: "Build AMmorph Wheel from source dist"
      before_install:
        - pip install pytest
      script:
        - python setup.py sdist
        - cd dist
        - pip wheel --no-deps ammorph-*.tar.gz
        - pip install ammorph-*.whl

    - stage: test
      name: "Test Installation"
      before_install:
        - pip install pytest
      install:
        - cd dist
        - pip install ammorph-*.whl
      script:
        - cd $TRAVIS_BUILD_DIR
        - pytest
